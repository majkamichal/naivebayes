<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title> • naivebayes</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="">
<meta property="og:description" content="naivebayes">
<meta property="og:image" content="https://majkamichal.github.io/naivebayes/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-87132983-2"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-87132983-2');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">naivebayes</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/naivebayes.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="https://cloud.r-project.org/web/packages/naivebayes/vignettes/intro_naivebayes.pdf" class="external-link">Introduction to Naive Bayes</a>
    </li>
    <li>
      <a href="../articles/specialized_naive_bayes.html">Specialized Naive Bayes</a>
    </li>
    <li>
      <a href="../articles/Sparse%20matrices.html">Sparse Matrices</a>
    </li>
    <li>
      <a href="../articles/caret,%20nproc%20and%20naivebayes.html">Caret, nproc and naivebayes</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://www.buymeacoffee.com/michalmajka" class="external-link">
    <span class="fa fa-mug-hot"></span>
     
  </a>
</li>
<li>
  <a href="http://twitter.com/majkamichal" class="external-link">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/majkamichal/naivebayes/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip></h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/majkamichal/naivebayes/blob/HEAD/vignettes/naivebayes.Rmd" class="external-link"><code>vignettes/naivebayes.Rmd</code></a></small>
      <div class="hidden name"><code>naivebayes.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">1) Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <code>naivebayes</code> package provides a user friendly
implementation of the Naïve Bayes algorithm via formula interlace and
classical combination of the matrix/data.frame containing the features
and a vector with the class labels. All functions can recognize missing
values, give informative warnings and more importantly - they know how
to handle them. In following the basic usage of the main function
<code><a href="../reference/naive_bayes.html">naive_bayes()</a></code> is demonstrated. Examples with the
specialized Naive Bayes classifiers can be found in <a href="https://majkamichal.github.io/naivebayes/articles/specialized_naive_bayes.html">this
article</a>.</p>
</div>
<div class="section level2">
<h2 id="example-data">2) Example data<a class="anchor" aria-label="anchor" href="#example-data"></a>
</h2>
<p>To demonstrate the usage of the <code>naivebayes</code> package, we
will use an example dataset. The dataset is simulated and consists of
various variables, including a class label, a binary variable, a
categorical variable, a logical variable, a normally distributed
variable, and a count variable.</p>
<p>The dataset contains 100 observations, and we split it into a
training set (train) consisting of the first 95 observations and a test
set (test) consisting of the remaining 5 observations. The test set
excludes the class label variable (class) to simulate new data for
classification.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/majkamichal/naivebayes" class="external-link">naivebayes</a></span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## naivebayes 1.0.0 loaded</span></code></pre>
<pre><code><span class="co">## For more information please visit:</span></code></pre>
<pre><code><span class="co">## https://majkamichal.github.io/naivebayes/</span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Simulate example data</span>
<span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">100</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
<span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>class <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"classA"</span>, <span class="st">"classB"</span><span class="op">)</span>, <span class="va">n</span>, <span class="cn">TRUE</span><span class="op">)</span>,
                   bern <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, <span class="va">n</span>, <span class="cn">TRUE</span><span class="op">)</span>,
                   cat  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, <span class="va">n</span>, <span class="cn">TRUE</span><span class="op">)</span>,
                   logical <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>,<span class="cn">FALSE</span><span class="op">)</span>, <span class="va">n</span>, <span class="cn">TRUE</span><span class="op">)</span>,
                   norm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>,
                   count <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="va">n</span>, lambda <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">15</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">train</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">95</span>, <span class="op">]</span>
<span class="va">test</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[</span><span class="fl">96</span><span class="op">:</span><span class="fl">100</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span>

<span class="co"># Show first and last 6 rows in the simulated training dataset</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">train</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##    class bern cat logical        norm count</span>
<span class="co">## 1 classA    B   b   FALSE -0.04470914     6</span>
<span class="co">## 2 classB    B   a    TRUE -1.73321841    16</span>
<span class="co">## 3 classA    B   b   FALSE  0.00213186     4</span>
<span class="co">## 4 classA    A   b   FALSE -0.63030033    20</span>
<span class="co">## 5 classB    A   b   FALSE -0.34096858     7</span>
<span class="co">## 6 classA    A   c   FALSE -1.15657236    12</span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">train</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##     class bern cat logical        norm count</span>
<span class="co">## 90 classB    A   b   FALSE -1.02454848    16</span>
<span class="co">## 91 classA    A   a    TRUE  0.32300650     5</span>
<span class="co">## 92 classA    B   c    TRUE  1.04361246    18</span>
<span class="co">## 93 classB    A   c    TRUE  0.09907849     7</span>
<span class="co">## 94 classB    B   b    TRUE -0.45413691     7</span>
<span class="co">## 95 classA    B   a    TRUE -0.65578185     4</span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Show the test dataset</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">test</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##     bern cat logical        norm count</span>
<span class="co">## 96     B   c   FALSE -0.03592242    16</span>
<span class="co">## 97     A   b    TRUE  1.06916146     9</span>
<span class="co">## 98     B   a   FALSE -0.48397493    13</span>
<span class="co">## 99     A   b   FALSE -0.12101011     4</span>
<span class="co">## 100    A   c   FALSE -1.29414000    13</span></code></pre>
</div>
<div class="section level2">
<h2 id="formula-interface">3) Formula interface<a class="anchor" aria-label="anchor" href="#formula-interface"></a>
</h2>
<p>The <code>naivebayes</code> package provides a convenient formula
interface for training and utilizing Naïve Bayes models. In this
section, we demonstrate how to use the formula interface to perform
various tasks.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Train the Naïve Bayes model using the formula interface</span>
<span class="va">nb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/naive_bayes.html">naive_bayes</a></span><span class="op">(</span><span class="va">class</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">train</span><span class="op">)</span>

<span class="co"># Summarize the trained model</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">nb</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## </span>
<span class="co">## ================================= Naive Bayes ================================== </span>
<span class="co">##  </span>
<span class="co">## - Call: naive_bayes.formula(formula = class ~ ., data = train) </span>
<span class="co">## - Laplace: 0 </span>
<span class="co">## - Classes: 2 </span>
<span class="co">## - Samples: 95 </span>
<span class="co">## - Features: 5 </span>
<span class="co">## - Conditional distributions: </span>
<span class="co">##     - Bernoulli: 2</span>
<span class="co">##     - Categorical: 1</span>
<span class="co">##     - Gaussian: 2</span>
<span class="co">## - Prior probabilities: </span>
<span class="co">##     - classA: 0.4842</span>
<span class="co">##     - classB: 0.5158</span>
<span class="co">## </span>
<span class="co">## --------------------------------------------------------------------------------</span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Perform classification on the test data</span>
<span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">nb</span>, <span class="va">test</span>, type <span class="op">=</span> <span class="st">"class"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] classA classB classA classA classA</span>
<span class="co">## Levels: classA classB</span></code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Equivalent way of performing the classification task</span>
<span class="va">nb</span> <span class="op"><a href="../reference/infix_class_prob.html">%class%</a></span> <span class="va">test</span></code></pre></div>
<pre><code><span class="co">## [1] classA classB classA classA classA</span>
<span class="co">## Levels: classA classB</span></code></pre>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Obtain posterior probabilities</span>
<span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">nb</span>, <span class="va">test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##         classA    classB</span>
<span class="co">## [1,] 0.7174638 0.2825362</span>
<span class="co">## [2,] 0.2599418 0.7400582</span>
<span class="co">## [3,] 0.6341795 0.3658205</span>
<span class="co">## [4,] 0.5365311 0.4634689</span>
<span class="co">## [5,] 0.7186026 0.2813974</span></code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Equivalent way of performing obtaining posterior probabilities</span>
<span class="va">nb</span> <span class="op"><a href="../reference/infix_class_prob.html">%prob%</a></span> <span class="va">test</span></code></pre></div>
<pre><code><span class="co">##         classA    classB</span>
<span class="co">## [1,] 0.7174638 0.2825362</span>
<span class="co">## [2,] 0.2599418 0.7400582</span>
<span class="co">## [3,] 0.6341795 0.3658205</span>
<span class="co">## [4,] 0.5365311 0.4634689</span>
<span class="co">## [5,] 0.7186026 0.2813974</span></code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Apply helper functions</span>
<span class="fu"><a href="../reference/tables.html">tables</a></span><span class="op">(</span><span class="va">nb</span>, <span class="fl">1</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## -------------------------------------------------------------------------------- </span>
<span class="co">## :: bern (Bernoulli) </span>
<span class="co">## -------------------------------------------------------------------------------- </span>
<span class="co">##     </span>
<span class="co">## bern    classA    classB</span>
<span class="co">##    A 0.5000000 0.5510204</span>
<span class="co">##    B 0.5000000 0.4489796</span>
<span class="co">## </span>
<span class="co">## --------------------------------------------------------------------------------</span></code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/get_cond_dist.html">get_cond_dist</a></span><span class="op">(</span><span class="va">nb</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##          bern           cat       logical          norm         count </span>
<span class="co">##   "Bernoulli" "Categorical"   "Bernoulli"    "Gaussian"    "Gaussian"</span></code></pre>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Note: By default, all "numeric" (integer, double) variables are modeled</span>
<span class="co">#       with a Gaussian distribution.</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="matrixdata-frame-and-class-vector">4) Matrix/data.frame and class vector<a class="anchor" aria-label="anchor" href="#matrixdata-frame-and-class-vector"></a>
</h2>
<p>In addition to the formula interface, the <code>naivebayes</code>
package also allows training Naïve Bayes models using a matrix or data
frame of features (X) and a vector of class labels (class). In this
section, we demonstrate how to utilize this approach.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Separate the features and class labels</span>
<span class="va">X</span> <span class="op">&lt;-</span> <span class="va">train</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>
<span class="va">class</span> <span class="op">&lt;-</span> <span class="va">train</span><span class="op">$</span><span class="va">class</span>

<span class="co"># Train the Naïve Bayes model using the matrix/data.frame and class vector</span>
<span class="va">nb2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/naive_bayes.html">naive_bayes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">X</span>, y <span class="op">=</span> <span class="va">class</span><span class="op">)</span>

<span class="co"># Obtain posterior probabilities for the test data</span>
<span class="va">nb2</span> <span class="op"><a href="../reference/infix_class_prob.html">%prob%</a></span> <span class="va">test</span></code></pre></div>
<pre><code><span class="co">##         classA    classB</span>
<span class="co">## [1,] 0.7174638 0.2825362</span>
<span class="co">## [2,] 0.2599418 0.7400582</span>
<span class="co">## [3,] 0.6341795 0.3658205</span>
<span class="co">## [4,] 0.5365311 0.4634689</span>
<span class="co">## [5,] 0.7186026 0.2813974</span></code></pre>
<p>In the code above, we first separate the features from the train
dataset by excluding the first column (which contains the class labels).
The features are stored in the matrix or data frame <code>X</code>, and
the corresponding class labels are stored in the vector
<code>class</code>.</p>
<p>Next, we train a Naïve Bayes model using the
<code><a href="../reference/naive_bayes.html">naive_bayes()</a></code> function by providing the feature matrix or
data frame (<code>x = X</code>) and the class vector
(<code>y = class</code>) as input arguments. The trained model is stored
in the <code>nb2</code> object.</p>
<p>To obtain the posterior probabilities of each class for the test
data, we use the <code>%prob%</code> operator with the <code>nb2</code>
object. This allows us to get the probabilities without explicitly using
the <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> function.</p>
<p>By using the matrix/data.frame and class vector approach, you can
directly train a Naïve Bayes model without the need for a formula
interface, providing flexibility in handling data structures.</p>
</div>
<div class="section level2">
<h2 id="non-parametric-estimation-for-continuous-features">5) Non-parametric estimation for continuous features<a class="anchor" aria-label="anchor" href="#non-parametric-estimation-for-continuous-features"></a>
</h2>
<p>Kernel density estimation (KDE) is a technique that can be used to
estimate the class conditional densities of continuous features in Naïve
Bayes modeling. By default, <code><a href="../reference/naive_bayes.html">naive_bayes()</a></code> function assumes
a Gaussian distribution for continuous features. However, you can
explicitly request KDE estimation by setting the parameter
<code>usekernel = TRUE</code>. KDE estimation is performed using the
built-in <code><a href="https://rdrr.io/r/stats/density.html" class="external-link">density()</a></code> function in R. By default, Gaussian
smoothing kernel and Silverman’s rule of thumb as bandwidth selector are
used.</p>
<p>In the following code snippet, we demonstrate the usage of KDE in
Naïve Bayes modeling:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Train a Naïve Bayes model with KDE</span>
<span class="va">nb_kde</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/naive_bayes.html">naive_bayes</a></span><span class="op">(</span><span class="va">class</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">train</span>, usekernel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">nb_kde</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## </span>
<span class="co">## ================================= Naive Bayes ================================== </span>
<span class="co">##  </span>
<span class="co">## - Call: naive_bayes.formula(formula = class ~ ., data = train, usekernel = TRUE) </span>
<span class="co">## - Laplace: 0 </span>
<span class="co">## - Classes: 2 </span>
<span class="co">## - Samples: 95 </span>
<span class="co">## - Features: 5 </span>
<span class="co">## - Conditional distributions: </span>
<span class="co">##     - Bernoulli: 2</span>
<span class="co">##     - Categorical: 1</span>
<span class="co">##     - KDE: 2</span>
<span class="co">## - Prior probabilities: </span>
<span class="co">##     - classA: 0.4842</span>
<span class="co">##     - classB: 0.5158</span>
<span class="co">## </span>
<span class="co">## --------------------------------------------------------------------------------</span></code></pre>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/get_cond_dist.html">get_cond_dist</a></span><span class="op">(</span><span class="va">nb_kde</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##          bern           cat       logical          norm         count </span>
<span class="co">##   "Bernoulli" "Categorical"   "Bernoulli"         "KDE"         "KDE"</span></code></pre>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nb_kde</span> <span class="op"><a href="../reference/infix_class_prob.html">%prob%</a></span> <span class="va">test</span></code></pre></div>
<pre><code><span class="co">##         classA    classB</span>
<span class="co">## [1,] 0.6498111 0.3501889</span>
<span class="co">## [2,] 0.2279460 0.7720540</span>
<span class="co">## [3,] 0.5915046 0.4084954</span>
<span class="co">## [4,] 0.5876798 0.4123202</span>
<span class="co">## [5,] 0.7017584 0.2982416</span></code></pre>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Plot class conditional densities</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">nb_kde</span>, <span class="st">"norm"</span>, arg.num <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>legend.cex <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span>, prob <span class="op">=</span> <span class="st">"conditional"</span><span class="op">)</span></code></pre></div>
<p><img src="naivebayes_files/figure-html/kde-1.png" width="700"></p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Plot marginal densities for each class</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">nb_kde</span>, <span class="st">"norm"</span>, arg.num <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>legend.cex <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span>, prob <span class="op">=</span> <span class="st">"marginal"</span><span class="op">)</span></code></pre></div>
<p><img src="naivebayes_files/figure-html/kde-2.png" width="700"></p>
<p>In the above code, we first train a Naïve Bayes model using the
formula interface and set <code>usekernel = TRUE</code> to enable KDE
estimation. We then use the <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> function to obtain a
summary of the trained model, including information about the
conditional distributions.</p>
<p>Next, we use the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> method to visualize the class
conditional densities (<code>prob = "conditional"</code>) and the
marginal densities for each class (<code>prob = "marginal"</code>). This
provides insights into the estimated densities of the continuous
features.</p>
<p>Additionally, we can customize the KDE estimation by adjusting the
<code>kernel</code> and <code>bandwidth</code> selection. The following
sections demonstrate how to (1) change the kernel, (2) bandwidth
selector, and (3) adjust the bandwidth:</p>
<div class="section level3">
<h3 id="changing-kernel">5.1) Changing kernel<a class="anchor" aria-label="anchor" href="#changing-kernel"></a>
</h3>
<p>In the <code><a href="../reference/naive_bayes.html">naive_bayes()</a></code> function, you have the flexibility
to specify the smoothing kernel to be used in KDE by using the
<code>kernel</code> parameter. There are seven different smoothing
kernels available, each with its own characteristics and effects on the
density estimation. Here are the available kernels (referenced from
<code><a href="https://rdrr.io/r/stats/density.html" class="external-link">help("density")</a></code>):</p>
<ul>
<li><p><code>gaussian</code>: (Default) This is the default kernel and
assumes a Gaussian (normal) distribution. It is commonly used and
provides a smooth density estimate.</p></li>
<li><p><code>epanechnikov</code>: This kernel has a quadratic shape and
provides a more localized density estimate compared to the Gaussian
kernel.</p></li>
<li><p><code>rectangular</code>: This kernel has a rectangular shape and
provides a simple, non-smooth density estimate.</p></li>
<li><p><code>triangular</code>: This kernel has a triangular shape and
provides a moderately smooth density estimate.</p></li>
<li><p><code>biweight</code>: This kernel has a quartic shape and
provides a more localized density estimate compared to the Gaussian
kernel.</p></li>
<li><p><code>cosine</code>: This kernel has a cosine shape and provides
a smooth density estimate.</p></li>
<li><p><code>optcosine</code>: This kernel is an optimized version of
the cosine kernel and provides a slightly more localized density
estimate.</p></li>
</ul>
<p>You can refer to visualizations of these kernel functions on
Wikipedia’s Kernel Functions page: <a href="https://en.wikipedia.org/wiki/Kernel_%28statistics%29#Kernel_functions_in_common_use" class="external-link uri">https://en.wikipedia.org/wiki/Kernel_%28statistics%29#Kernel_functions_in_common_use</a>.</p>
<p>By specifying the desired kernel using the <code>kernel</code>
parameter in the <code><a href="../reference/naive_bayes.html">naive_bayes()</a></code> function, you can choose the
smoothing approach that best suits your data and modeling
objectives.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Change Gaussian kernel to biweight kernel</span>
<span class="va">nb_kde_biweight</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/naive_bayes.html">naive_bayes</a></span><span class="op">(</span><span class="va">class</span> <span class="op">~</span> <span class="va">.</span>, 
                               <span class="va">train</span>, 
                               usekernel <span class="op">=</span> <span class="cn">TRUE</span>,
                               kernel <span class="op">=</span> <span class="st">"biweight"</span><span class="op">)</span>
<span class="va">nb_kde_biweight</span> <span class="op"><a href="../reference/infix_class_prob.html">%prob%</a></span> <span class="va">test</span></code></pre></div>
<pre><code><span class="co">##         classA    classB</span>
<span class="co">## [1,] 0.6564159 0.3435841</span>
<span class="co">## [2,] 0.2350606 0.7649394</span>
<span class="co">## [3,] 0.5917223 0.4082777</span>
<span class="co">## [4,] 0.5680244 0.4319756</span>
<span class="co">## [5,] 0.6981813 0.3018187</span></code></pre>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">nb_kde_biweight</span>, <span class="st">"norm"</span>, arg.num <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>legend.cex <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span>, prob <span class="op">=</span> <span class="st">"conditional"</span><span class="op">)</span></code></pre></div>
<p><img src="naivebayes_files/figure-html/kde_kernel-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="changing-bandwidth-selector">5.2) Changing bandwidth selector<a class="anchor" aria-label="anchor" href="#changing-bandwidth-selector"></a>
</h3>
<p>The bandwidth selector is a critical component of KDE as it
determines the width of the kernel and influences the smoothness of the
estimated density function. You can specify the bandwidth selector using
the <code>bw</code> parameter. Here are the available bandwidth
selectors, described based on the R documentation
<code><a href="https://rdrr.io/r/stats/bandwidth.html" class="external-link">help("bw.nrd0")</a></code>:</p>
<ul>
<li><p><code>nrd0</code> (Silverman’s rule-of-thumb): This is the
default bandwidth selector in R. It estimates the bandwidth based on
Silverman’s rule-of-thumb, which takes into account the sample size and
variance of the data. It provides a good balance between oversmoothing
and undersmoothing.</p></li>
<li><p><code>nrd</code> (variation of the rule-of-thumb): This is a
variation of Silverman’s rule-of-thumb, which adjusts the estimate based
on a factor of 1.06. It is slightly more conservative than
<code>nrd0</code>.</p></li>
<li><p><code>ucv</code> (unbiased cross-validation): This selector uses
unbiased cross-validation to estimate the bandwidth.</p></li>
<li><p><code>bcv</code> (biased cross-validation): This selector uses
biased cross-validation to estimate the bandwidth.</p></li>
<li><p><code>SJ</code> (Sheather &amp; Jones method): This selector
implements the Sheather-Jones plug-in method.</p></li>
</ul>
<p>Different bandwidth selectors can result in different levels of
smoothness in the estimated densities. It can be beneficial to
experiment with multiple selectors to find the most appropriate one for
your specific scenario.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nb_kde_SJ</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/naive_bayes.html">naive_bayes</a></span><span class="op">(</span><span class="va">class</span> <span class="op">~</span> <span class="va">.</span>, 
                         <span class="va">train</span>, 
                         usekernel <span class="op">=</span> <span class="cn">TRUE</span>,
                         bw <span class="op">=</span> <span class="st">"SJ"</span><span class="op">)</span>
<span class="va">nb_kde_SJ</span> <span class="op"><a href="../reference/infix_class_prob.html">%prob%</a></span> <span class="va">test</span></code></pre></div>
<pre><code><span class="co">##         classA    classB</span>
<span class="co">## [1,] 0.6127232 0.3872768</span>
<span class="co">## [2,] 0.1827263 0.8172737</span>
<span class="co">## [3,] 0.5784831 0.4215169</span>
<span class="co">## [4,] 0.7031048 0.2968952</span>
<span class="co">## [5,] 0.6699132 0.3300868</span></code></pre>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">nb_kde_SJ</span>, <span class="st">"norm"</span>, arg.num <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>legend.cex <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span>, prob <span class="op">=</span> <span class="st">"conditional"</span><span class="op">)</span></code></pre></div>
<p><img src="naivebayes_files/figure-html/kde_bw-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="adjusting-bandwidth">5.3) Adjusting bandwidth<a class="anchor" aria-label="anchor" href="#adjusting-bandwidth"></a>
</h3>
<p>You can further adjust the <code>bandwidth</code> by specifying a
factor using the <code>adjust</code>. This allows you to additionally
control the smoothness of the estimated densities.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nb_kde_adjust</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/naive_bayes.html">naive_bayes</a></span><span class="op">(</span><span class="va">class</span> <span class="op">~</span> <span class="va">.</span>, 
                             <span class="va">train</span>, 
                             usekernel <span class="op">=</span> <span class="cn">TRUE</span>,
                             adjust <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span>
<span class="va">nb_kde_adjust</span> <span class="op"><a href="../reference/infix_class_prob.html">%prob%</a></span> <span class="va">test</span></code></pre></div>
<pre><code><span class="co">##         classA    classB</span>
<span class="co">## [1,] 0.6773673 0.3226327</span>
<span class="co">## [2,] 0.2428289 0.7571711</span>
<span class="co">## [3,] 0.6081023 0.3918977</span>
<span class="co">## [4,] 0.5601651 0.4398349</span>
<span class="co">## [5,] 0.6910347 0.3089653</span></code></pre>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">nb_kde_adjust</span>, <span class="st">"norm"</span>, arg.num <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>legend.cex <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span>, prob <span class="op">=</span> <span class="st">"conditional"</span><span class="op">)</span></code></pre></div>
<p><img src="naivebayes_files/figure-html/kde_adjust-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="model-non-negative-integers-with-poisson-distribution">6) Model non-negative integers with Poisson distribution<a class="anchor" aria-label="anchor" href="#model-non-negative-integers-with-poisson-distribution"></a>
</h2>
<p>Class conditional distributions of non-negative integer predictors
can be modelled with Poisson distribution. This can be achieved by
setting <code>usepoisson=TRUE</code> in the <code><a href="../reference/naive_bayes.html">naive_bayes()</a></code>
function and by making sure that the variables representing counts in
the dataset are of class <code>integer</code>.</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">is.integer</a></span><span class="op">(</span><span class="va">train</span><span class="op">$</span><span class="va">count</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] TRUE</span></code></pre>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nb_pois</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/naive_bayes.html">naive_bayes</a></span><span class="op">(</span><span class="va">class</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">train</span>, usepoisson <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">nb_pois</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## </span>
<span class="co">## ================================= Naive Bayes ================================== </span>
<span class="co">##  </span>
<span class="co">## - Call: naive_bayes.formula(formula = class ~ ., data = train, usepoisson = TRUE) </span>
<span class="co">## - Laplace: 0 </span>
<span class="co">## - Classes: 2 </span>
<span class="co">## - Samples: 95 </span>
<span class="co">## - Features: 5 </span>
<span class="co">## - Conditional distributions: </span>
<span class="co">##     - Bernoulli: 2</span>
<span class="co">##     - Categorical: 1</span>
<span class="co">##     - Poisson: 1</span>
<span class="co">##     - Gaussian: 1</span>
<span class="co">## - Prior probabilities: </span>
<span class="co">##     - classA: 0.4842</span>
<span class="co">##     - classB: 0.5158</span>
<span class="co">## </span>
<span class="co">## --------------------------------------------------------------------------------</span></code></pre>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/get_cond_dist.html">get_cond_dist</a></span><span class="op">(</span><span class="va">nb_pois</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##          bern           cat       logical          norm         count </span>
<span class="co">##   "Bernoulli" "Categorical"   "Bernoulli"    "Gaussian"     "Poisson"</span></code></pre>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nb_pois</span> <span class="op"><a href="../reference/infix_class_prob.html">%prob%</a></span> <span class="va">test</span></code></pre></div>
<pre><code><span class="co">##         classA    classB</span>
<span class="co">## [1,] 0.6708181 0.3291819</span>
<span class="co">## [2,] 0.2792804 0.7207196</span>
<span class="co">## [3,] 0.6214784 0.3785216</span>
<span class="co">## [4,] 0.5806921 0.4193079</span>
<span class="co">## [5,] 0.7074807 0.2925193</span></code></pre>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Class conditional distributions</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">nb_pois</span>, <span class="st">"count"</span>, prob <span class="op">=</span> <span class="st">"conditional"</span><span class="op">)</span></code></pre></div>
<p><img src="naivebayes_files/figure-html/poisson-1.png" width="700"></p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Marginal distributions</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">nb_pois</span>, <span class="st">"count"</span>, prob <span class="op">=</span> <span class="st">"marginal"</span><span class="op">)</span></code></pre></div>
<p><img src="naivebayes_files/figure-html/poisson-2.png" width="700"></p>
<p>The code snippet checks if the count variable in the
<code>train</code> dataset is of class integer. Then, it fits a Naïve
Bayes model using the Poisson distribution by specifying
<code>usepoisson = TRUE</code> in the <code><a href="../reference/naive_bayes.html">naive_bayes()</a></code>
function.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Michal Majka.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
