<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Caret, nproc and naivebayes • naivebayes</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Caret, nproc and naivebayes">
<meta property="og:description" content="naivebayes">
<meta property="og:image" content="https://majkamichal.github.io/naivebayes/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-87132983-2"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-87132983-2');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">naivebayes</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/naivebayes.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="https://cloud.r-project.org/web/packages/naivebayes/vignettes/intro_naivebayes.pdf" class="external-link">Introduction to Naive Bayes</a>
    </li>
    <li>
      <a href="../articles/specialized_naive_bayes.html">Specialized Naive Bayes</a>
    </li>
    <li>
      <a href="../articles/Sparse%20matrices.html">Sparse Matrices</a>
    </li>
    <li>
      <a href="../articles/caret,%20nproc%20and%20naivebayes.html">Caret, nproc and naivebayes</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://www.buymeacoffee.com/michalmajka" class="external-link">
    <span class="fa fa-mug-hot"></span>
     
  </a>
</li>
<li>
  <a href="http://twitter.com/majkamichal" class="external-link">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/majkamichal/naivebayes/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Caret, nproc and naivebayes</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/majkamichal/naivebayes/blob/HEAD/vignettes/caret,%20nproc%20and%20naivebayes.Rmd" class="external-link"><code>vignettes/caret, nproc and naivebayes.Rmd</code></a></small>
      <div class="hidden name"><code>caret, nproc and naivebayes.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">1) Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <code><a href="../reference/naive_bayes.html">naive_bayes()</a></code> function, a powerful tool for
classification, is readily accessible through the highly regarded <a href="https://cran.r-project.org/web/packages/caret/index.html" class="external-link">Caret</a>
package. Additionally, it can be utilized seamlessly via the <a href="https://cran.r-project.org/web/packages/nproc/" class="external-link">nproc</a> package,
providing users with alternative options. This concise documentation
aims to demonstrate the basic usage of the <code><a href="../reference/naive_bayes.html">naive_bayes()</a></code>
function in both the <a href="https://cran.r-project.org/web/packages/caret/index.html" class="external-link">Caret</a>
and <a href="https://cran.r-project.org/web/packages/nproc/" class="external-link">nproc</a>
packages.</p>
</div>
<div class="section level2">
<h2 id="naive-bayes-in-caret">2) Naive Bayes in Caret<a class="anchor" aria-label="anchor" href="#naive-bayes-in-caret"></a>
</h2>
<p>The first part showcases how to train a Naive Bayes model using the
<code><a href="../reference/naive_bayes.html">naive_bayes()</a></code> function within the <code>caret</code>
interface in R. It provides an example of how to prepare the data, train
the Naive Bayes model, and perform classification using the trained
model. This section focuses on the core steps of training a Naive Bayes
model and utilizing it for classification tasks.</p>
<p>The second part demonstrates the process of defining a tuning grid,
performing resampling, and finding the “optimal” Naive Bayes model using
the <code>caret</code> package in R. It outlines how to define a grid of
tuning parameters, train multiple models with different parameter
combinations, and select the best-performing model based on resampling
techniques. This section emphasizes the importance of tuning the Naive
Bayes model to achieve better performance and provides insights into the
parameter selection process.</p>
<p>By combining these two sections, users can gain a comprehensive
understanding of how to train and optimize Naive Bayes models using the
<code><a href="../reference/naive_bayes.html">naive_bayes()</a></code> function within the <code>caret</code>
interface in R.</p>
<div class="section level4">
<h4 id="model-training-with-caret">2.1) Model Training with Caret<a class="anchor" aria-label="anchor" href="#model-training-with-caret"></a>
</h4>
<p>The model is trained using the <code><a href="https://rdrr.io/pkg/caret/man/train.html" class="external-link">caret::train()</a></code> function,
specifying <code>"naive_bayes"</code> as the method and setting
<code>usepoisson</code> to TRUE to handle the count variable.</p>
<p>After training the model, classification can be performed by using
the trained model to predict the class labels. Additionally, the model
provides posterior probabilities, which can be obtained for further
analysis.</p>
<p>If needed, the code allows accessing the underlying
<code>naive_bayes</code> object, providing access to additional
information and functionalities of the Naive Bayes model.</p>
<p>Overall, the code demonstrates the process of training a Naive Bayes
model, performing classification, and accessing the model object for
further analysis using the <code>caret</code> interface in R.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/topepo/caret/" class="external-link">caret</a></span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/majkamichal/naivebayes" class="external-link">naivebayes</a></span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## naivebayes 1.0.0 loaded</span></code></pre>
<pre><code><span class="co">## For more information please visit:</span></code></pre>
<pre><code><span class="co">## https://majkamichal.github.io/naivebayes/</span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Load the iris dataset</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span>

<span class="co"># Prepare the data</span>
<span class="va">new</span> <span class="op">&lt;-</span> <span class="va">iris</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
<span class="va">new</span><span class="op">$</span><span class="va">Discrete</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">new</span><span class="op">)</span>, <span class="cn">TRUE</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
<span class="va">new</span><span class="op">$</span><span class="va">Counts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span> 


<span class="co"># Train the Naive Bayes model with the Caret package</span>
<span class="va">naive_bayes_via_caret</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/caret/man/train.html" class="external-link">train</a></span><span class="op">(</span><span class="va">Species</span> <span class="op">~</span> <span class="va">.</span>, 
                               data <span class="op">=</span> <span class="va">new</span>, 
                               method <span class="op">=</span> <span class="st">"naive_bayes"</span>, 
                               usepoisson <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="co">## Print the trained model</span>
<span class="co"># naive_bayes_via_caret</span>

<span class="co"># Perform classification</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">naive_bayes_via_caret</span>, newdata <span class="op">=</span> <span class="va">new</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] setosa setosa setosa setosa setosa setosa</span>
<span class="co">## Levels: setosa versicolor virginica</span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Get posterior probabilities</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">naive_bayes_via_caret</span>, newdata <span class="op">=</span> <span class="va">new</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##      setosa   versicolor    virginica</span>
<span class="co">## 1 1.0000000 2.004949e-08 9.549385e-14</span>
<span class="co">## 2 1.0000000 4.242500e-08 3.229798e-13</span>
<span class="co">## 3 1.0000000 2.512936e-08 1.566929e-13</span>
<span class="co">## 4 0.9999999 5.203335e-08 5.710476e-13</span>
<span class="co">## 5 1.0000000 2.004949e-08 9.549385e-14</span>
<span class="co">## 6 0.9999514 4.860925e-05 4.128918e-10</span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Access the underlying naive_bayes object</span>
<span class="va">nb_object</span> <span class="op">&lt;-</span> <span class="va">naive_bayes_via_caret</span><span class="op">$</span><span class="va">finalModel</span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">nb_object</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] "naive_bayes"</span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># nb_object</span></code></pre></div>
</div>
<div class="section level4">
<h4 id="parameter-tuning-with-caret">2.2) Parameter Tuning with Caret<a class="anchor" aria-label="anchor" href="#parameter-tuning-with-caret"></a>
</h4>
<p>First, a tuning grid is defined using the <code><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid()</a></code>
function, which specifies different combinations of tuning parameters
for the Naive Bayes model.</p>
<p>Then, the Naive Bayes model is fitted with parameter tuning using the
<code><a href="https://rdrr.io/pkg/caret/man/train.html" class="external-link">caret::train()</a></code> function. The <code>tuneGrid</code> argument
is used to provide the defined tuning grid. The resulting model is
stored in the <code>naive_bayes_via_caret2</code> object.</p>
<p>To view the selected tuning parameters, you can access
<code>naive_bayes_via_caret2$finalModel$tuneValue</code>. If you
uncomment the respective line of code, you can also view the final Naive
Bayes model itself.</p>
<p>The tuning process can be visualized using the generic
<code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> function, which provides insights into the
performance of different parameter combinations.</p>
<p>Finally, the trained model is used to perform classification on new
data by using the <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> function. The class labels of
the new data can be obtained with
<code>predict(naive_bayes_via_caret2, newdata = new)</code>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Define tuning grid </span>
<span class="va">nb_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>usekernel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span>,
                       laplace <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span>, 
                       adjust <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.75</span>, <span class="fl">1</span>, <span class="fl">1.25</span>, <span class="fl">1.5</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Fit the Naive Bayes model with parameter tuning</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2550</span><span class="op">)</span>
<span class="va">naive_bayes_via_caret2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/caret/man/train.html" class="external-link">train</a></span><span class="op">(</span><span class="va">Species</span> <span class="op">~</span> <span class="va">.</span>, 
                                data <span class="op">=</span> <span class="va">new</span>, 
                                method <span class="op">=</span> <span class="st">"naive_bayes"</span>,
                                usepoisson <span class="op">=</span> <span class="cn">TRUE</span>,
                                tuneGrid <span class="op">=</span> <span class="va">nb_grid</span><span class="op">)</span>

<span class="co"># View the selected tuning parameters</span>
<span class="va">naive_bayes_via_caret2</span><span class="op">$</span><span class="va">finalModel</span><span class="op">$</span><span class="va">tuneValue</span></code></pre></div>
<pre><code><span class="co">##    laplace usekernel adjust</span>
<span class="co">## 16       0      TRUE    1.5</span></code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## View the final naive_bayes model</span>
<span class="co"># naive_bayes_via_caret2$finalModel</span>

<span class="co"># Visualize the tuning process</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">naive_bayes_via_caret2</span><span class="op">)</span></code></pre></div>
<p><img src="caret,%20nproc%20and%20naivebayes_files/figure-html/example_caret2-1.png" width="700"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Perform classification </span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">naive_bayes_via_caret2</span>, newdata <span class="op">=</span> <span class="va">new</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] setosa setosa setosa setosa setosa setosa</span>
<span class="co">## Levels: setosa versicolor virginica</span></code></pre>
<p>Overall, the code showcases the steps involved in defining a tuning
grid, performing model training with parameter tuning, visualizing the
tuning process, and applying the trained model for classification using
the Naive Bayes algorithm within the caret package in R.</p>
</div>
</div>
<div class="section level2">
<h2 id="naive-bayes-in-nproc">3) Naive Bayes in nproc<a class="anchor" aria-label="anchor" href="#naive-bayes-in-nproc"></a>
</h2>
<p>The <a href="https://cran.r-project.org/web/packages/nproc/" class="external-link">nproc</a> package
provides Neyman-Pearson (NP) classification algorithms and NP receiver
operating characteristic (NP-ROC) curves, and it can be used in
conjunction with the <code>naivebayes package</code>. By incorporating
the <code>naivebayes</code> package within the NP classification
framework, users can leverage the power of the naive Bayes algorithm for
binary classification tasks while controlling type I and type II errors
effectively. This integration allows practitioners to apply the NP
paradigm to the naive Bayes classifier and enhance its performance in
various application domains.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Example usage with nproc and naivebayes packages</span>

<span class="co"># install.packages("nproc")</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://advances.sciencemag.org/content/4/2/eaao1659" class="external-link">nproc</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/majkamichal/naivebayes" class="external-link">naivebayes</a></span><span class="op">)</span>

<span class="co"># Simulate data</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2550</span><span class="op">)</span>
<span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1000</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span> <span class="op">*</span> <span class="fl">2</span><span class="op">)</span>, <span class="va">n</span>, <span class="fl">2</span><span class="op">)</span>
<span class="va">c</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">+</span> <span class="fl">3</span> <span class="op">*</span> <span class="va">x</span><span class="op">[</span> ,<span class="fl">1</span><span class="op">]</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">c</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">xtest</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span> <span class="op">*</span> <span class="fl">2</span><span class="op">)</span>, <span class="va">n</span>, <span class="fl">2</span><span class="op">)</span>
<span class="va">ctest</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">+</span> <span class="fl">3</span> <span class="op">*</span> <span class="va">xtest</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>
<span class="va">ytest</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">ctest</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>


<span class="co"># Train Naive Bayes classifier such that the type I error alpha is no bigger than 5%</span>
<span class="va">naive_bayes_via_nproc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nproc/man/npc.html" class="external-link">npc</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, method <span class="op">=</span> <span class="st">"nb"</span>, alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span>

<span class="co">## Recover the "naive_bayes" object</span>
<span class="co"># naive_bayes_via_nproc$fits[[1]]$fit</span>

<span class="co"># Classification</span>
<span class="va">nb_pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">naive_bayes_via_nproc</span>, <span class="va">xtest</span><span class="op">)</span>

<span class="co"># head(nb_pred$pred.label)</span>

<span class="co"># Obtain various measures</span>
<span class="va">accuracy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">nb_pred</span><span class="op">$</span><span class="va">pred.label</span> <span class="op">==</span> <span class="va">ytest</span><span class="op">)</span>
<span class="va">ind0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">ytest</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span>
<span class="va">ind1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">ytest</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span>
<span class="va">typeI</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">nb_pred</span><span class="op">$</span><span class="va">pred.label</span><span class="op">[</span><span class="va">ind0</span><span class="op">]</span> <span class="op">!=</span> <span class="va">ytest</span><span class="op">[</span><span class="va">ind0</span><span class="op">]</span><span class="op">)</span>  <span class="co"># type I error on test set</span>
<span class="va">typeII</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">nb_pred</span><span class="op">$</span><span class="va">pred.label</span><span class="op">[</span><span class="va">ind1</span><span class="op">]</span> <span class="op">!=</span> <span class="va">ytest</span><span class="op">[</span><span class="va">ind1</span><span class="op">]</span><span class="op">)</span> <span class="co"># type II error on test set</span>

<span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">" Overall Accuracy: "</span>,  <span class="va">accuracy</span>,<span class="st">"\n"</span>,
    <span class="st">"Type I error:     "</span>, <span class="va">typeI</span>, <span class="st">"\n"</span>,
    <span class="st">"Type II error:    "</span>, <span class="va">typeII</span>, <span class="st">"\n"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##  Overall Accuracy:  0.689 </span>
<span class="co">##  Type I error:      0.02590674 </span>
<span class="co">##  Type II error:     0.490228</span></code></pre>
<p>The provided code demonstrates the usage of the <code>nproc</code>
and <code>naivebayes</code> packages in R.</p>
<p>First, the necessary packages are loaded. Then, synthetic data is
generated using the <code><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed()</a></code> function to ensure
reproducibility. The data consists of two independent variables
(<code>x</code>) and a binary response variable (<code>y</code>). A test
dataset (<code>xtest</code>) is also generated for evaluation.</p>
<p>Next, the naive Bayes classifier is applied using the
<code><a href="https://rdrr.io/pkg/nproc/man/npc.html" class="external-link">npc()</a></code> function from the <code>nproc</code> package, with
the method set to <code>"nb"</code> for naive Bayes. The
<code>alpha</code> parameter is set to <code>0.05</code>, defining a
desirable upper bound on type I error.</p>
<p>After training the classifier, predictions are made on the test
dataset using the <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> function. The accuracy of the
predictions is calculated by comparing the predicted labels
(<code>nb_pred$pred.label</code>) with the true labels
(<code>ytest</code>).</p>
<p>Additionally, type I and type II errors are computed by comparing the
predicted labels with the true labels separately for class 0 and class 1
instances. The type I error corresponds to misclassifying class 0
observations as class 1, while the type II error represents
misclassifying class 1 observations as class 0.</p>
<p>Finally, the overall accuracy, type I error, and type II error are
printed to the console using the <code><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat()</a></code> function.</p>
<p>The code demonstrates how to leverage the <code>nproc</code> and
<code>naivebayes</code> packages to apply the Neyman-Pearson
classification paradigm<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> to the naive Bayes classifier and evaluate
its performance in terms of accuracy and error rates.</p>
</div>
<div class="footnotes footnotes-end-of-document">
<hr>
<ol>
<li id="fn1"><p><a href="http://advances.sciencemag.org/content/4/2/eaao1659" class="external-link uri">http://advances.sciencemag.org/content/4/2/eaao1659</a><a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Michal Majka.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
