<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="naivebayes">
<title>Specialized Naive Bayes • naivebayes</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Specialized Naive Bayes">
<meta property="og:description" content="naivebayes">
<meta property="og:image" content="https://majkamichal.github.io/naivebayes/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-7PD351XYFE"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-7PD351XYFE');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">naivebayes</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/naivebayes.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="external-link dropdown-item" href="https://cloud.r-project.org/web/packages/naivebayes/vignettes/intro_naivebayes.pdf">Introduction to Naive Bayes</a>
    <a class="dropdown-item" href="../articles/specialized_naive_bayes.html">Specialized Naive Bayes</a>
    <a class="dropdown-item" href="../articles/Sparse%20matrices.html">Sparse Matrices</a>
    <a class="dropdown-item" href="../articles/caret,%20nproc%20and%20naivebayes.html">Caret, nproc and naivebayes</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://www.buymeacoffee.com/michalmajka" aria-label="BuyMeACoffee">
    <span class="fa fa-mug-hot"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="http://twitter.com/majkamichal" aria-label="Twitter">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/majkamichal/naivebayes/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Specialized Naive Bayes</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/majkamichal/naivebayes/blob/HEAD/vignettes/specialized_naive_bayes.Rmd" class="external-link"><code>vignettes/specialized_naive_bayes.Rmd</code></a></small>
      <div class="d-none name"><code>specialized_naive_bayes.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">1) Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <code>naivebayes</code> package offers a comprehensive set of
functions that implement specialized versions of the Naïve Bayes
classifier. In this article, we explore these functions and provide a
detailed overview of their basic usage.</p>
<p>The package provides five key functions that cater to different types
of data:</p>
<ol style="list-style-type: decimal">
<li><p><code><a href="../reference/bernoulli_naive_bayes.html">bernoulli_naive_bayes()</a></code>: Ideal for binary data, this
function is specifically tailored to handle situations where the
features are binary in nature, taking values of either 0 or 1. It
effectively models the relationship between these binary features and
the class labels.</p></li>
<li><p><code><a href="../reference/multinomial_naive_bayes.html">multinomial_naive_bayes()</a></code>: This function is
specifically designed for multinomial data. It is well-suited for cases
where the features are discrete and have multiple categories. For
example, it is commonly used in text classification tasks, where word
counts are utilized as features.</p></li>
<li><p><code><a href="../reference/poisson_naive_bayes.html">poisson_naive_bayes()</a></code>: This function is specifically
designed for count data. It is well-suited for scenarios where the
features represent counts or frequencies. By assuming a Poisson
distribution for the features, this function effectively models the
relationship between the counts and the class labels.</p></li>
<li><p><code><a href="../reference/gaussian_naive_bayes.html">gaussian_naive_bayes()</a></code>: Suitable for continuous
data, this function assumes that the features follow a Gaussian (normal)
distribution. It is commonly used when dealing with continuous numerical
features, and it models the relationship between these features and the
class labels.</p></li>
<li><p><code><a href="../reference/nonparametric_naive_bayes.html">nonparametric_naive_bayes()</a></code> This function introduces
a nonparametric variant of the Naïve Bayes classifier. Unlike the
specialized versions mentioned above, it does not make any assumptions
regarding the specific distribution of the continuous features. Instead,
it employs kernel density estimation to estimate the class conditional
probabilities and feature distributions in a nonparametric manner. This
allows for more flexible modeling and can be particularly useful when
dealing with data that deviates from typical parametric
assumptions.</p></li>
</ol>
<p>Throughout this article, we will dive into each of these functions
providing illustrative examples to demonstrate their practical usage. By
the end, you will have a solid understanding of how to leverage these
specialized versions of the Naïve Bayes classifier to tackle various
types of data and classification problems.</p>
<p>We will also show equivalent calculations using the general
<code><a href="../reference/naive_bayes.html">naive_bayes()</a></code> function, allowing you to compare and
understand the differences between the specialized and general
approaches.</p>
</div>
<div class="section level2">
<h2 id="bernoulli-naive-bayes">2) Bernoulli Naive Bayes<a class="anchor" aria-label="anchor" href="#bernoulli-naive-bayes"></a>
</h2>
<p>The Bernoulli Naive Bayes classifier is suitable for binary data. To
demonstrate its usage, we start by simulating a dataset with binary
features. We then train the Bernoulli Naive Bayes model using the
<code><a href="../reference/bernoulli_naive_bayes.html">bernoulli_naive_bayes()</a></code> function.</p>
<p><strong>Simulate data:</strong></p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/majkamichal/naivebayes" class="external-link">naivebayes</a></span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## naivebayes 1.0.0 loaded</span></code></pre>
<pre><code><span class="co">## For more information please visit:</span></code></pre>
<pre><code><span class="co">## https://majkamichal.github.io/naivebayes/</span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cols</span> <span class="op">&lt;-</span> <span class="fl">10</span> ; <span class="va">rows</span> <span class="op">&lt;-</span> <span class="fl">100</span> ; <span class="va">probs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0"</span> <span class="op">=</span> <span class="fl">0.4</span>, <span class="st">"1"</span> <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>
<span class="va">M</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">1</span>, <span class="va">rows</span> <span class="op">*</span> <span class="va">cols</span>, <span class="cn">TRUE</span>, <span class="va">probs</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">rows</span>, ncol <span class="op">=</span> <span class="va">cols</span><span class="op">)</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"class"</span>, <span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>, <span class="va">rows</span>, <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.7</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"V"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><strong>Train the Bernoulli Naive Bayes model:</strong></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">laplace</span> <span class="op">&lt;-</span> <span class="fl">0.5</span>
<span class="va">bnb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bernoulli_naive_bayes.html">bernoulli_naive_bayes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">M</span>, y <span class="op">=</span> <span class="va">y</span>, laplace <span class="op">=</span> <span class="va">laplace</span><span class="op">)</span> <span class="co"># M has to be a matrix</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">bnb</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## </span>
<span class="co">## ============================ Bernoulli Naive Bayes ============================= </span>
<span class="co">##  </span>
<span class="co">## - Call: bernoulli_naive_bayes(x = M, y = y, laplace = laplace) </span>
<span class="co">## - Laplace: 0.5 </span>
<span class="co">## - Classes: 2 </span>
<span class="co">## - Samples: 100 </span>
<span class="co">## - Features: 10 </span>
<span class="co">## - Prior probabilities: </span>
<span class="co">##     - classA: 0.4</span>
<span class="co">##     - classB: 0.6</span>
<span class="co">## </span>
<span class="co">## --------------------------------------------------------------------------------</span></code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">bnb</span>, newdata <span class="op">=</span> <span class="va">M</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span><span class="op">)</span> </code></pre></div>
<pre><code><span class="co">##         classA     classB</span>
<span class="co">## [1,] 0.1137533 0.88624671</span>
<span class="co">## [2,] 0.9114579 0.08854215</span>
<span class="co">## [3,] 0.6855916 0.31440841</span>
<span class="co">## [4,] 0.2994114 0.70058855</span>
<span class="co">## [5,] 0.3185296 0.68147042</span>
<span class="co">## [6,] 0.3185296 0.68147042</span></code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Equivalently</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">bnb</span> <span class="op"><a href="../reference/infix_class_prob.html">%prob%</a></span> <span class="va">M</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##         classA     classB</span>
<span class="co">## [1,] 0.1137533 0.88624671</span>
<span class="co">## [2,] 0.9114579 0.08854215</span>
<span class="co">## [3,] 0.6855916 0.31440841</span>
<span class="co">## [4,] 0.2994114 0.70058855</span>
<span class="co">## [5,] 0.3185296 0.68147042</span>
<span class="co">## [6,] 0.3185296 0.68147042</span></code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Visualise marginal distributions</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">bnb</span>, which <span class="op">=</span> <span class="st">"V1"</span>, prob <span class="op">=</span> <span class="st">"marginal"</span><span class="op">)</span></code></pre></div>
<p><img src="specialized_naive_bayes_files/figure-html/unnamed-chunk-1-1.png" width="700"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Obtain model coefficients</span>
<span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">bnb</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##      classA:0  classA:1  classB:0   classB:1</span>
<span class="co">## V1  0.8170732 0.1829268 0.8114754 0.18852459</span>
<span class="co">## V2  0.7439024 0.2560976 0.7459016 0.25409836</span>
<span class="co">## V3  0.7682927 0.2317073 0.9262295 0.07377049</span>
<span class="co">## V4  0.6951220 0.3048780 0.8606557 0.13934426</span>
<span class="co">## V5  0.7195122 0.2804878 0.7786885 0.22131148</span>
<span class="co">## V6  0.8170732 0.1829268 0.7295082 0.27049180</span>
<span class="co">## V7  0.7439024 0.2560976 0.7622951 0.23770492</span>
<span class="co">## V8  0.7926829 0.2073171 0.8442623 0.15573770</span>
<span class="co">## V9  0.8658537 0.1341463 0.7459016 0.25409836</span>
<span class="co">## V10 0.7682927 0.2317073 0.8114754 0.18852459</span></code></pre>
<p><strong>Equivalent calculation with naive_bayes
function:</strong></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># It is made sure that the columns are factors with the 0-1 levels)</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span>, <span class="va">factor</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co"># sapply(df, class)</span>
<span class="va">nb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/naive_bayes.html">naive_bayes</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">y</span>, laplace <span class="op">=</span> <span class="va">laplace</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">nb</span> <span class="op"><a href="../reference/infix_class_prob.html">%prob%</a></span> <span class="va">df</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##         classA     classB</span>
<span class="co">## [1,] 0.1137533 0.88624671</span>
<span class="co">## [2,] 0.9114579 0.08854215</span>
<span class="co">## [3,] 0.6855916 0.31440841</span>
<span class="co">## [4,] 0.2994114 0.70058855</span>
<span class="co">## [5,] 0.3185296 0.68147042</span>
<span class="co">## [6,] 0.3185296 0.68147042</span></code></pre>
</div>
<div class="section level2">
<h2 id="multinomial-naive-bayes">3) Multinomial Naive Bayes<a class="anchor" aria-label="anchor" href="#multinomial-naive-bayes"></a>
</h2>
<p>Next, we explore the Multinomial Naive Bayes classifier. We simulate
a dataset with multinomial features and train the model using the
<code><a href="../reference/multinomial_naive_bayes.html">multinomial_naive_bayes()</a></code> function. We discuss the summary
of the model, perform classification, compute posterior probabilities,
and examine parameter estimates. Note that this specialized model is
<strong>not</strong> available in the general <code><a href="../reference/naive_bayes.html">naive_bayes()</a></code>
function.</p>
<p><strong>Simulate data:</strong></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
<span class="va">cols</span> <span class="op">&lt;-</span> <span class="fl">3</span> <span class="co"># words</span>
<span class="va">rows</span> <span class="op">&lt;-</span> <span class="fl">10000</span> <span class="co"># all documents</span>
<span class="va">rows_spam</span> <span class="op">&lt;-</span> <span class="fl">100</span> <span class="co"># spam documents</span>

<span class="va">word_prob_non_spam</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/proportions.html" class="external-link">prop.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">cols</span><span class="op">)</span><span class="op">)</span>
<span class="va">word_prob_spam</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/proportions.html" class="external-link">prop.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">cols</span><span class="op">)</span><span class="op">)</span>

<span class="va">M1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Multinom.html" class="external-link">rmultinom</a></span><span class="op">(</span><span class="va">rows_spam</span>, size <span class="op">=</span> <span class="va">cols</span>, prob <span class="op">=</span> <span class="va">word_prob_spam</span><span class="op">)</span><span class="op">)</span>
<span class="va">M2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Multinom.html" class="external-link">rmultinom</a></span><span class="op">(</span><span class="va">rows</span> <span class="op">-</span> <span class="va">rows_spam</span>, size <span class="op">=</span> <span class="va">cols</span>, prob <span class="op">=</span> <span class="va">word_prob_non_spam</span><span class="op">)</span><span class="op">)</span>
<span class="va">M</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">M1</span>, <span class="va">M2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"word"</span>, <span class="fl">1</span><span class="op">:</span><span class="va">cols</span><span class="op">)</span> ; <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"doc"</span>, <span class="fl">1</span><span class="op">:</span><span class="va">rows</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##      word1 word2 word3</span>
<span class="co">## doc1     3     0     0</span>
<span class="co">## doc2     2     0     1</span>
<span class="co">## doc3     0     0     3</span>
<span class="co">## doc4     1     1     1</span>
<span class="co">## doc5     1     1     1</span>
<span class="co">## doc6     1     1     1</span></code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"spam"</span>, <span class="va">rows_spam</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"non-spam"</span>, <span class="va">rows</span> <span class="op">-</span> <span class="va">rows_spam</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><strong>Train the Multinomial Naive Bayes:</strong></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">laplace</span> <span class="op">&lt;-</span> <span class="fl">0.5</span>
<span class="va">mnb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/multinomial_naive_bayes.html">multinomial_naive_bayes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">M</span>, y <span class="op">=</span> <span class="va">y</span>, laplace <span class="op">=</span> <span class="va">laplace</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mnb</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## </span>
<span class="co">## =========================== Multinomial Naive Bayes ============================ </span>
<span class="co">##  </span>
<span class="co">## - Call: multinomial_naive_bayes(x = M, y = y, laplace = laplace) </span>
<span class="co">## - Laplace: 0.5 </span>
<span class="co">## - Classes: 2 </span>
<span class="co">## - Samples: 10000 </span>
<span class="co">## - Features: 3 </span>
<span class="co">## - Prior probabilities: </span>
<span class="co">##     - non-spam: 0.99</span>
<span class="co">##     - spam: 0.01</span>
<span class="co">## </span>
<span class="co">## --------------------------------------------------------------------------------</span></code></pre>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Classification</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mnb</span>, <span class="va">M</span><span class="op">)</span><span class="op">)</span> <span class="co"># head(mnb %class% M)</span></code></pre></div>
<pre><code><span class="co">## [1] non-spam non-spam non-spam non-spam non-spam non-spam</span>
<span class="co">## Levels: non-spam spam</span></code></pre>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Posterior probabilities</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mnb</span>, <span class="va">M</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span><span class="op">)</span> <span class="co"># head(mnb %prob% M)</span></code></pre></div>
<pre><code><span class="co">##       non-spam        spam</span>
<span class="co">## doc1 0.9181347 0.081865335</span>
<span class="co">## doc2 0.9621482 0.037851834</span>
<span class="co">## doc3 0.9923996 0.007600361</span>
<span class="co">## doc4 0.9928194 0.007180558</span>
<span class="co">## doc5 0.9928194 0.007180558</span>
<span class="co">## doc6 0.9928194 0.007180558</span></code></pre>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Parameter estimates</span>
<span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">mnb</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##        non-spam      spam</span>
<span class="co">## word1 0.2190630 0.4527363</span>
<span class="co">## word2 0.3099002 0.1177446</span>
<span class="co">## word3 0.4710368 0.4295191</span></code></pre>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Compare estimates to the true probabilities</span>
<span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>non_spam <span class="op">=</span> <span class="va">word_prob_non_spam</span>, spam <span class="op">=</span> <span class="va">word_prob_spam</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##      non_spam   spam</span>
<span class="co">## [1,]   0.2193 0.4522</span>
<span class="co">## [2,]   0.3074 0.1004</span>
<span class="co">## [3,]   0.4732 0.4473</span></code></pre>
</div>
<div class="section level2">
<h2 id="poisson-naive-bayes">4) Poisson Naive Bayes<a class="anchor" aria-label="anchor" href="#poisson-naive-bayes"></a>
</h2>
<p>The Poisson Naive Bayes classifier is specifically designed for count
data. We simulate count data and train the model using the
<code><a href="../reference/poisson_naive_bayes.html">poisson_naive_bayes()</a></code> function. We analyze the summary of
the model, perform prediction, visualize marginal distributions, and
obtain model coefficients.</p>
<p><strong>Simulate data:</strong></p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cols</span> <span class="op">&lt;-</span> <span class="fl">10</span> ; <span class="va">rows</span> <span class="op">&lt;-</span> <span class="fl">100</span>
<span class="va">M</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="va">rows</span> <span class="op">*</span> <span class="va">cols</span>, lambda <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">rows</span>, ncol <span class="op">=</span> <span class="va">cols</span><span class="op">)</span>
<span class="co"># is.integer(M) # [1] TRUE</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"class"</span>, <span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>, <span class="va">rows</span>, <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"V"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><strong>Train the Poisson Naive Bayes:</strong></p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">laplace</span> <span class="op">&lt;-</span> <span class="fl">0</span>
<span class="va">pnb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/poisson_naive_bayes.html">poisson_naive_bayes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">M</span>, y <span class="op">=</span> <span class="va">y</span>, laplace <span class="op">=</span> <span class="va">laplace</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">pnb</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## </span>
<span class="co">## ============================= Poisson Naive Bayes ============================== </span>
<span class="co">##  </span>
<span class="co">## - Call: poisson_naive_bayes(x = M, y = y, laplace = laplace) </span>
<span class="co">## - Laplace: 0 </span>
<span class="co">## - Classes: 2 </span>
<span class="co">## - Samples: 100 </span>
<span class="co">## - Features: 10 </span>
<span class="co">## - Prior probabilities: </span>
<span class="co">##     - classA: 0.5</span>
<span class="co">##     - classB: 0.5</span>
<span class="co">## </span>
<span class="co">## --------------------------------------------------------------------------------</span></code></pre>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">pnb</span>, newdata <span class="op">=</span> <span class="va">M</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##         classA    classB</span>
<span class="co">## [1,] 0.2940922 0.7059078</span>
<span class="co">## [2,] 0.4930894 0.5069106</span>
<span class="co">## [3,] 0.3974324 0.6025676</span>
<span class="co">## [4,] 0.6535412 0.3464588</span>
<span class="co">## [5,] 0.6698435 0.3301565</span>
<span class="co">## [6,] 0.4771426 0.5228574</span></code></pre>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Visualise marginal distributions</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pnb</span>, which <span class="op">=</span> <span class="st">"V1"</span>, prob <span class="op">=</span> <span class="st">"marginal"</span><span class="op">)</span></code></pre></div>
<p><img src="specialized_naive_bayes_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Obtain model coefficients</span>
<span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">pnb</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##     classA classB</span>
<span class="co">## V1    2.84   2.90</span>
<span class="co">## V2    2.74   2.90</span>
<span class="co">## V3    2.54   3.06</span>
<span class="co">## V4    3.12   2.68</span>
<span class="co">## V5    2.98   3.12</span>
<span class="co">## V6    2.84   3.20</span>
<span class="co">## V7    3.26   2.78</span>
<span class="co">## V8    3.24   3.08</span>
<span class="co">## V9    3.06   2.96</span>
<span class="co">## V10   2.76   2.96</span></code></pre>
<p><strong>Equivalent calculation with naive_bayes
function:</strong></p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nb2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/naive_bayes.html">naive_bayes</a></span><span class="op">(</span><span class="va">M</span>, <span class="va">y</span>, usepoisson <span class="op">=</span> <span class="cn">TRUE</span>, laplace <span class="op">=</span> <span class="va">laplace</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">nb2</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##         classA    classB</span>
<span class="co">## [1,] 0.2940922 0.7059078</span>
<span class="co">## [2,] 0.4930894 0.5069106</span>
<span class="co">## [3,] 0.3974324 0.6025676</span>
<span class="co">## [4,] 0.6535412 0.3464588</span>
<span class="co">## [5,] 0.6698435 0.3301565</span>
<span class="co">## [6,] 0.4771426 0.5228574</span></code></pre>
</div>
<div class="section level2">
<h2 id="gaussian-naive-bayes">5) Gaussian Naive Bayes<a class="anchor" aria-label="anchor" href="#gaussian-naive-bayes"></a>
</h2>
<p>The Gaussian Naive Bayes classifier is discussed next. We use the
famous <code>Iris</code><a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;&lt;a href="https://en.wikipedia.org/wiki/Iris_flower_data_set" class="external-link uri"&gt;https://en.wikipedia.org/wiki/Iris_flower_data_set&lt;/a&gt;&lt;/p&gt;'><sup>1</sup></a> dataset and train the Gaussian Naive Bayes
model using the <code><a href="../reference/gaussian_naive_bayes.html">gaussian_naive_bayes()</a></code> function. We
summarize the model, visualize class conditional distributions, and
obtain parameter estimates. <strong>Data:</strong></p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="va">iris</span><span class="op">[[</span><span class="fl">5</span><span class="op">]</span><span class="op">]</span>
<span class="va">M</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span><span class="op">-</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<p><strong>Train the Gaussian Naive Bayes:</strong></p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gnb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gaussian_naive_bayes.html">gaussian_naive_bayes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">M</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">gnb</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## </span>
<span class="co">## ============================= Gaussian Naive Bayes ============================= </span>
<span class="co">##  </span>
<span class="co">## - Call: gaussian_naive_bayes(x = M, y = y) </span>
<span class="co">## - Samples: 150 </span>
<span class="co">## - Features: 4 </span>
<span class="co">## - Prior probabilities: </span>
<span class="co">##     - setosa: 0.3333</span>
<span class="co">##     - versicolor: 0.3333</span>
<span class="co">##     - virginica: 0.3333</span>
<span class="co">## </span>
<span class="co">## --------------------------------------------------------------------------------</span></code></pre>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">gnb</span>, newdata <span class="op">=</span> <span class="va">M</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##      setosa   versicolor    virginica</span>
<span class="co">## [1,]      1 2.981309e-18 2.152373e-25</span>
<span class="co">## [2,]      1 3.169312e-17 6.938030e-25</span>
<span class="co">## [3,]      1 2.367113e-18 7.240956e-26</span>
<span class="co">## [4,]      1 3.069606e-17 8.690636e-25</span>
<span class="co">## [5,]      1 1.017337e-18 8.885794e-26</span>
<span class="co">## [6,]      1 2.717732e-14 4.344285e-21</span></code></pre>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Visualise class conditional distributions</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gnb</span>, which <span class="op">=</span> <span class="st">"Sepal.Width"</span>, prob <span class="op">=</span> <span class="st">"conditional"</span><span class="op">)</span></code></pre></div>
<p><img src="specialized_naive_bayes_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Obtain parameter estimates</span>
<span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">gnb</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##              setosa:mu setosa:sd versicolor:mu versicolor:sd virginica:mu</span>
<span class="co">## Sepal.Length     5.006 0.3524897         5.936     0.5161711        6.588</span>
<span class="co">## Sepal.Width      3.428 0.3790644         2.770     0.3137983        2.974</span>
<span class="co">## Petal.Length     1.462 0.1736640         4.260     0.4699110        5.552</span>
<span class="co">## Petal.Width      0.246 0.1053856         1.326     0.1977527        2.026</span>
<span class="co">##              virginica:sd</span>
<span class="co">## Sepal.Length    0.6358796</span>
<span class="co">## Sepal.Width     0.3224966</span>
<span class="co">## Petal.Length    0.5518947</span>
<span class="co">## Petal.Width     0.2746501</span></code></pre>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">gnb</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>,<span class="cn">FALSE</span><span class="op">)</span><span class="op">]</span> <span class="co"># Only means</span></code></pre></div>
<pre><code><span class="co">##              setosa:mu versicolor:mu virginica:mu</span>
<span class="co">## Sepal.Length     5.006         5.936        6.588</span>
<span class="co">## Sepal.Width      3.428         2.770        2.974</span>
<span class="co">## Petal.Length     1.462         4.260        5.552</span>
<span class="co">## Petal.Width      0.246         1.326        2.026</span></code></pre>
<p><strong>Equivalent calculation with general naive_bayes
function:</strong></p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nb3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/naive_bayes.html">naive_bayes</a></span><span class="op">(</span><span class="va">M</span>, <span class="va">y</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">nb3</span>, newdata <span class="op">=</span> <span class="va">M</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##      setosa   versicolor    virginica</span>
<span class="co">## [1,]      1 2.981309e-18 2.152373e-25</span>
<span class="co">## [2,]      1 3.169312e-17 6.938030e-25</span>
<span class="co">## [3,]      1 2.367113e-18 7.240956e-26</span>
<span class="co">## [4,]      1 3.069606e-17 8.690636e-25</span>
<span class="co">## [5,]      1 1.017337e-18 8.885794e-26</span>
<span class="co">## [6,]      1 2.717732e-14 4.344285e-21</span></code></pre>
</div>
<div class="section level2">
<h2 id="non-parametric-naive-bayes">6) Non-Parametric Naive Bayes<a class="anchor" aria-label="anchor" href="#non-parametric-naive-bayes"></a>
</h2>
<p>Lastly, we explore the Non-Parametric Naive Bayes classifier. Again,
using the <code>Iris</code><a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;&lt;a href="https://en.wikipedia.org/wiki/Iris_flower_data_set" class="external-link uri"&gt;https://en.wikipedia.org/wiki/Iris_flower_data_set&lt;/a&gt;&lt;/p&gt;'><sup>2</sup></a> dataset, we train the model using the
<code><a href="../reference/nonparametric_naive_bayes.html">nonparametric_naive_bayes()</a></code> function. We will visualize the
class conditional distributions, perform classification, so that it can
be compared to the Gaussian Naive Bayes demonstrated in a previous
section.</p>
<p><strong>Data:</strong></p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="va">iris</span><span class="op">[[</span><span class="fl">5</span><span class="op">]</span><span class="op">]</span>
<span class="va">M</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span><span class="op">-</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<p><strong>Train the Non-Parametric Naive Bayes:</strong></p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nnb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nonparametric_naive_bayes.html">nonparametric_naive_bayes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">M</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span>
<span class="co"># summary(nnb)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">nnb</span>, newdata <span class="op">=</span> <span class="va">M</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##         setosa   versicolor    virginica</span>
<span class="co">## [1,] 1.0000000 3.066728e-09 9.020367e-11</span>
<span class="co">## [2,] 0.9999999 4.873896e-08 1.352291e-09</span>
<span class="co">## [3,] 1.0000000 1.985693e-08 1.152477e-09</span>
<span class="co">## [4,] 1.0000000 1.151469e-08 6.592116e-10</span>
<span class="co">## [5,] 1.0000000 8.886374e-10 8.621293e-11</span>
<span class="co">## [6,] 1.0000000 3.842342e-09 5.960213e-09</span></code></pre>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">nnb</span>, which <span class="op">=</span> <span class="st">"Sepal.Width"</span>, prob <span class="op">=</span> <span class="st">"conditional"</span><span class="op">)</span></code></pre></div>
<p><img src="specialized_naive_bayes_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<p><strong>Equivalent calculation with general naive_bayes
function:</strong></p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nb4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/naive_bayes.html">naive_bayes</a></span><span class="op">(</span><span class="va">M</span>, <span class="va">y</span>, usekernel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">nb4</span>, newdata <span class="op">=</span> <span class="va">M</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##         setosa   versicolor    virginica</span>
<span class="co">## [1,] 1.0000000 3.066728e-09 9.020367e-11</span>
<span class="co">## [2,] 0.9999999 4.873896e-08 1.352291e-09</span>
<span class="co">## [3,] 1.0000000 1.985693e-08 1.152477e-09</span>
<span class="co">## [4,] 1.0000000 1.151469e-08 6.592116e-10</span>
<span class="co">## [5,] 1.0000000 8.886374e-10 8.621293e-11</span>
<span class="co">## [6,] 1.0000000 3.842342e-09 5.960213e-09</span></code></pre>
</div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Michal Majka.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
